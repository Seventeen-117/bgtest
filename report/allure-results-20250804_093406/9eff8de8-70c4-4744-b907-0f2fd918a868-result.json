{"name": "test_chat_gateway_optimized[case1]", "status": "broken", "statusDetails": {"message": "Exception: 请求失败: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))", "trace": ".venv\\lib\\site-packages\\urllib3\\connection.py:199: in _new_conn\n    sock = connection.create_connection(\n.venv\\lib\\site-packages\\urllib3\\util\\connection.py:85: in create_connection\n    raise err\n.venv\\lib\\site-packages\\urllib3\\util\\connection.py:73: in create_connection\n    sock.connect(sa)\nE   ConnectionRefusedError: [WinError 10061] 由于目标计算机积极拒绝，无法连接。\n\nThe above exception was the direct cause of the following exception:\n.venv\\lib\\site-packages\\urllib3\\connectionpool.py:789: in urlopen\n    response = self._make_request(\n.venv\\lib\\site-packages\\urllib3\\connectionpool.py:495: in _make_request\n    conn.request(\n.venv\\lib\\site-packages\\urllib3\\connection.py:441: in request\n    self.endheaders()\n..\\AppData\\Local\\Programs\\Python\\Python38\\lib\\http\\client.py:1247: in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n..\\AppData\\Local\\Programs\\Python\\Python38\\lib\\http\\client.py:1007: in _send_output\n    self.send(msg)\n..\\AppData\\Local\\Programs\\Python\\Python38\\lib\\http\\client.py:947: in send\n    self.connect()\n.venv\\lib\\site-packages\\urllib3\\connection.py:279: in connect\n    self.sock = self._new_conn()\n.venv\\lib\\site-packages\\urllib3\\connection.py:214: in _new_conn\n    raise NewConnectionError(\nE   urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。\n\nThe above exception was the direct cause of the following exception:\n.venv\\lib\\site-packages\\requests\\adapters.py:667: in send\n    resp = conn.urlopen(\n.venv\\lib\\site-packages\\urllib3\\connectionpool.py:843: in urlopen\n    retries = retries.increment(\n.venv\\lib\\site-packages\\urllib3\\util\\retry.py:519: in increment\n    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]\nE   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n\nDuring handling of the above exception, another exception occurred:\ncommon\\test_utils.py:107: in execute_http_request\n    resp = http_request_with_allure(\nutils\\allure_utils.py:288: in http_request_with_allure\n    response = http_utils.request(method, url, **kwargs)\nutils\\http_utils.py:286: in request\n    response = self._make_request(method, url, **kwargs)\nutils\\http_utils.py:129: in _make_request\n    response = self.session.request(\n.venv\\lib\\site-packages\\requests\\sessions.py:589: in request\n    resp = self.send(prep, **send_kwargs)\n.venv\\lib\\site-packages\\requests\\sessions.py:703: in send\n    r = adapter.send(request, **kwargs)\n.venv\\lib\\site-packages\\requests\\adapters.py:700: in send\n    raise ConnectionError(e, request=request)\nE   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n\nDuring handling of the above exception, another exception occurred:\ntestcase\\test_chat_gateway_optimized.py:39: in test_chat_gateway_optimized\n    success = test_utils.execute_test_case(case, use_allure=True)\ncommon\\test_utils.py:274: in execute_test_case\n    response = self.execute_http_request(\ncommon\\test_utils.py:133: in execute_http_request\n    raise Exception(error_msg)\nE   Exception: 请求失败: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))"}, "description": "优化后的聊天网关测试用例", "steps": [{"name": "测试设置: Unknown.test_chat_gateway_optimized[case1]", "status": "passed", "start": 1754271268847, "stop": 1754271268848}, {"name": "测试用例: 聊天网关API测试", "status": "broken", "statusDetails": {"message": "Exception: 请求失败: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n", "trace": "  File \"C:\\Users\\sy_li\\bgtest\\utils\\allure_decorators.py\", line 31, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 29, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\allure_decorators.py\", line 62, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 54, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\allure_decorators.py\", line 80, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 79, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 300, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 210, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\testcase\\test_chat_gateway_optimized.py\", line 39, in test_chat_gateway_optimized\n    success = test_utils.execute_test_case(case, use_allure=True)\n  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 274, in execute_test_case\n    response = self.execute_http_request(\n  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 133, in execute_http_request\n    raise Exception(error_msg)\n"}, "steps": [{"name": "API测试: 聊天网关", "status": "broken", "statusDetails": {"message": "Exception: 请求失败: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n", "trace": "  File \"C:\\Users\\sy_li\\bgtest\\utils\\allure_decorators.py\", line 62, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 54, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\allure_decorators.py\", line 80, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 79, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 300, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 210, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\testcase\\test_chat_gateway_optimized.py\", line 39, in test_chat_gateway_optimized\n    success = test_utils.execute_test_case(case, use_allure=True)\n  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 274, in execute_test_case\n    response = self.execute_http_request(\n  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 133, in execute_http_request\n    raise Exception(error_msg)\n"}, "steps": [{"name": "数据驱动测试: test_chat_gateway.yaml", "status": "broken", "statusDetails": {"message": "Exception: 请求失败: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n", "trace": "  File \"C:\\Users\\sy_li\\bgtest\\utils\\allure_decorators.py\", line 80, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 79, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 300, in wrapper\n    return func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\test_decorators.py\", line 210, in wrapper\n    result = func(*args, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\testcase\\test_chat_gateway_optimized.py\", line 39, in test_chat_gateway_optimized\n    success = test_utils.execute_test_case(case, use_allure=True)\n  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 274, in execute_test_case\n    response = self.execute_http_request(\n  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 133, in execute_http_request\n    raise Exception(error_msg)\n"}, "steps": [{"name": "执行用例: 2 - 异常请求-缺少message参数", "status": "broken", "statusDetails": {"message": "Exception: 请求失败: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n", "trace": "  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 274, in execute_test_case\n    response = self.execute_http_request(\n  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 133, in execute_http_request\n    raise Exception(error_msg)\n"}, "steps": [{"name": "准备请求参数", "status": "passed", "attachments": [{"name": "请求参数", "source": "f6bcfd42-2596-41ee-9248-e81628312d1a-attachment.json", "type": "application/json"}], "start": 1754271268851, "stop": 1754271268852}, {"name": "发送POST请求到 http://localhost:8688/api/chatGatWay-internal", "status": "broken", "statusDetails": {"message": "Exception: 请求失败: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n", "trace": "  File \"C:\\Users\\sy_li\\bgtest\\common\\test_utils.py\", line 133, in execute_http_request\n    raise Exception(error_msg)\n"}, "steps": [{"name": "HTTP请求: POST http://localhost:8688/api/chatGatWay-internal", "status": "broken", "statusDetails": {"message": "requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8688): Max retries exceeded with url: /api/chatGatWay-internal (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001EAEE161A00>: Failed to establish a new connection: [WinError 10061] 由于目标计算机积极拒绝，无法连接。'))\n", "trace": "  File \"C:\\Users\\sy_li\\bgtest\\utils\\allure_utils.py\", line 288, in http_request_with_allure\n    response = http_utils.request(method, url, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\http_utils.py\", line 286, in request\n    response = self._make_request(method, url, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\utils\\http_utils.py\", line 129, in _make_request\n    response = self.session.request(\n  File \"C:\\Users\\sy_li\\bgtest\\.venv\\lib\\site-packages\\requests\\sessions.py\", line 589, in request\n    resp = self.send(prep, **send_kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\.venv\\lib\\site-packages\\requests\\sessions.py\", line 703, in send\n    r = adapter.send(request, **kwargs)\n  File \"C:\\Users\\sy_li\\bgtest\\.venv\\lib\\site-packages\\requests\\adapters.py\", line 700, in send\n    raise ConnectionError(e, request=request)\n"}, "attachments": [{"name": "Request Details", "source": "b7876a3b-147f-49d1-95da-d2a719fc628d-attachment.json", "type": "application/json"}, {"name": "HTTP请求异常: POST http://localhost:8688/api/chatGatWay-internal", "source": "616805f7-ba12-4a62-8a18-b9f16e5d520c-attachment.json", "type": "application/json"}], "start": 1754271268852, "stop": 1754271272873}], "attachments": [{"name": "错误信息", "source": "2545dbe5-da0b-41ba-9915-790e99ef6166-attachment.txt", "type": "text/plain"}], "start": 1754271268852, "stop": 1754271272876}], "attachments": [{"name": "测试用例: 2", "source": "d2a16d1c-ee1b-4d97-8287-da0f371055f1-attachment.json", "type": "application/json"}], "start": 1754271268850, "stop": 1754271272879}], "attachments": [{"name": "数据驱动信息", "source": "40b5e9c7-953f-47ce-8237-8a2b3d558636-attachment.txt", "type": "text/plain"}, {"name": "数据驱动测试异常: test_chat_gateway.yaml", "source": "1d26029d-9034-4318-9f1c-9c7a3e249b0c-attachment.json", "type": "application/json"}], "start": 1754271268849, "stop": 1754271272882}], "attachments": [{"name": "API信息", "source": "de1f7c17-2c0a-442a-834a-be9c5f3f0737-attachment.txt", "type": "text/plain"}, {"name": "API测试异常: 聊天网关", "source": "0c3ab811-61bc-4570-adb1-0619c658b758-attachment.json", "type": "application/json"}], "start": 1754271268848, "stop": 1754271272885}], "attachments": [{"name": "测试用例异常: 聊天网关API测试", "source": "8c8e8a57-45fe-4435-aae5-3f0c61a1883a-attachment.json", "type": "application/json"}], "start": 1754271268848, "stop": 1754271272889}, {"name": "测试清理: Unknown.test_chat_gateway_optimized[case1]", "status": "passed", "start": 1754271273385, "stop": 1754271273460}], "attachments": [{"name": "测试异常", "source": "7e5bf94e-2219-4074-9863-4b8a97d18bbf-attachment.json", "type": "application/json"}, {"name": "异常堆栈", "source": "67518380-9feb-4e1c-8136-1c1f09bb19f4-attachment.txt", "type": "text/plain"}, {"name": "log", "source": "d6c198c9-660d-4e12-82b3-6abf3d7b37b9-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "case", "value": "{'case_id': 2, 'description': '异常请求-缺少message参数', 'url': 'http://localhost:8688/api/chatGatWay-internal', 'method': 'POST', 'params': {'user_id': 'user002'}, 'expected_result': {'code': 400, 'msg': '参数缺失: message', 'data': {}}}"}], "start": 1754271268848, "stop": 1754271272890, "uuid": "e265dc7b-e3b6-42d1-a590-1f9482a787e0", "historyId": "47d4f1acb122ceaa3cba5f27fc09017b", "testCaseId": "2a48a67b57e896f2d1924bc3e0d75f83", "fullName": "testcase.test_chat_gateway_optimized#test_chat_gateway_optimized", "labels": [{"name": "story", "value": "API测试"}, {"name": "severity", "value": "critical"}, {"name": "feature", "value": "聊天网关"}, {"name": "tag", "value": "smoke"}, {"name": "parentSuite", "value": "testcase"}, {"name": "suite", "value": "test_chat_gateway_optimized"}, {"name": "host", "value": "lihaojie"}, {"name": "thread", "value": "89128-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "testcase.test_chat_gateway_optimized"}], "titlePath": ["testcase", "test_chat_gateway_optimized.py"]}